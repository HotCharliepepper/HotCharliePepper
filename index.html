<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WKND ë³µì¡°ë¦¬ ê¹œì§ ì´ë²¤íŠ¸</title>
  <style>
    :root { --bg:#0b0b0f; --card:#12121a; --txt:#f3f3f6; --mut:#b8b8c6; --line:#2a2a39; }
    * { box-sizing:border-box; }
    body { margin:0; font-family: Pretendard, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans KR", sans-serif;
      background: radial-gradient(80rem 40rem at 50% -10%, #2a1a00 0%, rgba(0,0,0,0) 55%), var(--bg);
      color:var(--txt);
    }
    .wrap { max-width:880px; margin:0 auto; padding:28px 16px 56px; }
    .badge { display:inline-flex; gap:8px; align-items:center; padding:8px 12px; border:1px solid var(--line); border-radius:999px; color:var(--mut); }
    h1 { margin:14px 0 8px; font-size:28px; letter-spacing:-0.3px; }
    p { margin:0; color:var(--mut); line-height:1.6; }
    .grid { display:grid; grid-template-columns:1fr; gap:14px; margin-top:18px; }
    @media (min-width:900px){ .grid{ grid-template-columns: 1.2fr 0.8fr; } }
    .card { background:rgba(18,18,26,0.82); border:1px solid var(--line); border-radius:18px; padding:18px; backdrop-filter: blur(8px); }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .sep { height:1px; background:var(--line); margin:14px 0; }
    .big { font-size:18px; color:var(--txt); }
    .mut { color:var(--mut); }
    .pill { padding:6px 10px; border:1px dashed var(--line); border-radius:999px; color:var(--mut); font-size:13px; }
    input { width:100%; padding:12px 12px; border-radius:12px; border:1px solid var(--line); background:#0f0f16; color:var(--txt); }
    button { width:100%; padding:12px 14px; border-radius:12px; border:1px solid #3a2a0a; background:linear-gradient(180deg,#ffcc66 0%, #c98b1a 100%);
      color:#1a1200; font-weight:800; cursor:pointer;
    }
    button:disabled { opacity:.45; cursor:not-allowed; }
    .result { padding:12px; border-radius:14px; border:1px solid var(--line); background:#0f0f16; white-space:pre-line; }
    .tiny { font-size:12px; color:#8f8fa3; line-height:1.5; }
    .count { font-variant-numeric: tabular-nums; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="badge">ğŸ§§ WKNDMOOD ë³µì¡°ë¦¬ ê¹œì§ ì´ë²¤íŠ¸</div>
    <h1>ì„¤ì—°íœ´ ë§ˆì§€ë§‰ ì°¬ìŠ¤, ì„ ì°©ìˆœìœ¼ë¡œ â€œë³µ(í˜œíƒ)â€ì„ ê°€ì ¸ê°€ì„¸ìš”.</h1>
    <p>ì´ë²¤íŠ¸ ì˜¤í”ˆ ì‹œê°„ì— <b>ë³µì¡°ë¦¬ ì—´ê¸°</b> ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤. ë‚¨ì€ ìˆ˜ëŸ‰ì´ ë³´ì´ëŠ” ìˆœê°„, ì´ë¯¸ ë°˜ì€ ì„±ê³µì…ë‹ˆë‹¤.</p>

    <div class="grid">
      <div class="card">
        <div class="row">
          <div class="pill">ë‚¨ì€ ë³µ(ì¬ê³ )</div>
          <div id="remain" class="mut count">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>
        </div>
        <div class="sep"></div>

        <div class="row" style="align-items:flex-start;">
          <div style="flex:1; min-width:240px;">
            <div class="big">ë‹‰ë„¤ì„(ì˜¤í”ˆí†¡ ì´ë¦„)ë§Œ ì ê³  ì°¸ì—¬</div>
            <div class="tiny">â€» ì¤‘ë³µ ìˆ˜ë ¹ ë°©ì§€ë¥¼ ìœ„í•´ ì„œë²„ì—ì„œ IP ê¸°ë°˜ â€œ1íšŒ í´ë ˆì„â€ì„ ê¸°ë³¸ ì ìš©í•©ë‹ˆë‹¤. </div>
            <div style="height:10px"></div>
            <input id="nickname" maxlength="20" placeholder="ì˜ˆ) ë‹‰ë„¤ì„ / í‚¤ / ëª¸ë¬´ê²Œ />
           </div>
            <button id="btn" disabled>ë³µì¡°ë¦¬ ì—´ê¸° ğŸ§§</button>
          </div>

          <div style="flex:1; min-width:240px;">
            <div class="big">ì•ˆë‚´</div>
            <div class="tiny">
              1) ë‹¹ì²¨ë˜ë©´ <b>í´ë ˆì„ ì½”ë“œ</b>ê°€ ë‚˜ì˜µë‹ˆë‹¤.<br/>
              2) ê·¸ í™”ë©´ì„ ìº¡ì²˜í•´ì„œ ìš´ì˜ìì—ê²Œ ë³´ë‚´ë©´ í˜œíƒ í™•ì •.<br/>
              3) ì†Œì§„ë˜ë©´ ì°¸ê°€ìƒ ë©”ì‹œì§€ë¡œ ì „í™˜ë©ë‹ˆë‹¤.
            </div>
            <div class="sep"></div>
            <div id="status" class="result">ì´ë²¤íŠ¸ ìƒíƒœ í™•ì¸ ì¤‘â€¦</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="big">ê²½í’ˆ(ì˜ˆì‹œ)</div>
        <div class="sep"></div>
        <div class="tiny">
          ğŸ¥‡ 1ë³µ(ì´ˆë ˆì–´) : 10ë§Œì›ê¶Œ/í• ì¸ (1ëª…)<br/>
          ğŸ¥ˆ 2ë³µ(ë ˆì–´) : 3ë§Œì›ê¶Œ/30% í• ì¸ (3ëª…)<br/>
          ğŸ¥‰ 3ë³µ(ê¸°ë³¸) : 1ë§Œì›ê¶Œ/10% í• ì¸ (10ëª…)<br/>
          ğŸ ì°¸ê°€ìƒ : ì¸ìƒ ì •ëˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ + ë‹¤ìŒ í–‰ì‚¬ ìš°ì„  ì•Œë¦¼
        </div>
        <div class="sep"></div>
        <div class="tiny">
        </div>
      </div>
    </div>
  </div>

  <script>
    const $remain = document.getElementById('remain');
    const $btn = document.getElementById('btn');
    const $status = document.getElementById('status');
    const $nickname = document.getElementById('nickname');

    async function refreshStatus(){
      const res = await fetch('/api/status', { cache: 'no-store' });
      const data = await res.json();

      const remainText = `1ë³µ:${data.remaining.p1} Â· 2ë³µ:${data.remaining.p2} Â· 3ë³µ:${data.remaining.p3} (ì´ ${data.remaining.total})`;
      $remain.textContent = remainText;

      if (!data.isOpen) {
        $btn.disabled = true;
        $status.textContent =
          `â³ ì•„ì§ ì˜¤í”ˆ ì „ì…ë‹ˆë‹¤.\nì˜¤í”ˆ: ${data.window.startKST}\në§ˆê°: ${data.window.endKST}\n\nì§€ê¸ˆì€ ëŒ€ê¸° ëª¨ë“œì…ë‹ˆë‹¤. ì˜¤í”ˆë˜ë©´ ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤.`;
        return;
      }

      $btn.disabled = false;
      $status.textContent = `âœ… ì§€ê¸ˆ ì˜¤í”ˆ ì¤‘!\në‚¨ì€ ë³µì´ ë³´ì´ëŠ” ì§€ê¸ˆì´ íƒ€ì´ë°ì…ë‹ˆë‹¤.\n\n(ì†Œì§„ ì‹œ ìë™ìœ¼ë¡œ ì°¸ê°€ìƒìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.)`;
    }

    async function claim(){
      const nickname = ($nickname.value || '').trim();
      if (!nickname) {
        $status.textContent = 'ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ ì£¼ì„¸ìš” ğŸ™‚';
        return;
      }

      $btn.disabled = true;
      $status.textContent = 'ë³µì¡°ë¦¬ ì—¬ëŠ” ì¤‘â€¦(ì„œë²„ í™•ì¸ ì¤‘)';

      try {
        const res = await fetch('/api/claim', {
          method: 'POST',
          headers: { 'content-type': 'application/json' },
          body: JSON.stringify({ nickname })
        });

        const data = await res.json();

        if (!res.ok) {
          $status.textContent = `âš ï¸ ${data.message || 'ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'}`;
        } else {
          if (data.prize.type === 'NONE') {
            $status.textContent =
              `ğŸ˜… ì•„ì‰½ê²Œë„ ì˜¤ëŠ˜ì˜ ë³µ(ê²½í’ˆ)ì€ ëª¨ë‘ ì†Œì§„!\n\nê·¸ë˜ë„ ì°¸ê°€ìƒì€ ë“œë¦½ë‹ˆë‹¤:\n${data.prize.label}\n\në‹¤ìŒ ì´ë²¤íŠ¸ ìš°ì„  ì•Œë¦¼ë„ ê°™ì´ ë°›ì„ ìˆ˜ ìˆì–´ìš”.`;
          } else {
            $status.textContent =
              `ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë‹¹ì‹ ì˜ ë³µ(í˜œíƒ)ì€:\n${data.prize.label}\n\ní´ë ˆì„ ì½”ë“œ: ${data.claimCode}\n\nì´ í™”ë©´ ìº¡ì²˜ â†’ ìš´ì˜ìì—ê²Œ ë³´ë‚´ë©´ í˜œíƒ í™•ì •!`;
          }
        }
      } catch (e) {
        $status.textContent = 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜â€¦ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.';
      } finally {
        await refreshStatus();
      }
    }

    $btn.addEventListener('click', claim);
    refreshStatus();
    setInterval(refreshStatus, 6000);
  </script>
</body>
</html>



